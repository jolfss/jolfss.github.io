<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="{{ .Description }}">
        <title>{{ .Title }} | My Site</title>

        <!-- MathJax configuration -->
        <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                // Allow MathJax to process inline math ($...$) inside code blocks
                // by removing 'pre' from skipHtmlTags
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea']
            }
        };
        </script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

        <!-- <link rel="stylesheet" href="/css/style.css"> -->
        {{ $style := resources.Get "scss/main.scss" | toCSS | minify | fingerprint }}
        <link rel="stylesheet" href="{{ $style.RelPermalink }}" integrity="{{ $style.Data.Integrity }}">
    </head>
    <body class="{{ if .IsHome }}page-home{{ else }}page-{{ .Section }}{{ end }}">
        <div>
            <!--  if not .IsHome  -->
            <!-- We use a custom header for the home page which is defined in its main.html -->
            {{ partial "header.html" . }}
             <!-- end  -->

            <main>
                {{ block "main" . }}{{ end }}
                {{ partial "bibliography.html" . }}
            </main>

            {{ partial "footer.html" . }}

            <!-- Add the resizing scripts here; NOTE I don't know what js.Build does -->
            {{ $remHeightScript := resources.Get "js/rem-height-ceil.js" | js.Build }}
            {{ if $remHeightScript }}
                <script src="{{ $remHeightScript.RelPermalink }}"></script>
            {{ end }}

            {{ $cTagScript := resources.Get "js/c-tag-occupy-and-expand.js" | js.Build }}
            {{ if $cTagScript }}
                <script src="{{ $cTagScript.RelPermalink }}"></script>
            {{ end }}

            <!-- Add the image preview script -->
            {{ $imagePreviewScript := resources.Get "js/image-preview.js" | js.Build }}
            {{ if $imagePreviewScript }}
                <script src="{{ $imagePreviewScript.RelPermalink }}"></script>
            {{ end }}

            {{ $debugGridScript := resources.Get "js/debug-grid.js" | js.Build }}
            {{ if $debugGridScript }}
                <script src="{{ $debugGridScript.RelPermalink }}"></script>
            {{ end }}
        </div>
    </body>
</html>
