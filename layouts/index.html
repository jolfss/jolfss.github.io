{{/* This content will be injected into the baseof.html template */}}
{{ define "main" }}
    <div class="quote">
        <h2>{{ .Params.quote }}</h2>
        <p>--{{ .Params.quote_author }}</p>
    </div>
    <div class="portrait">
        <div class="images">
            <img src="{{ .Params.portrait }}" alt="{{ .Params.portrait_alt_text }}">
        </div>
        <div class="text">
            <p>{{ .Params.welcome_text }}</p>
        </div>
    </div>

    {{ .Content }}

    <h2>Select Projects</h2>
    <div> 
        {{ range first 5 
            (where 
                (where .Site.Pages.ByDate.Reverse "Section" "projects") 
            ".Params.featured" true) 
        }}
            <div class="project">
                {{ $page := . }}
                <div class="images">
                    {{ range .Params.media }}
                        <img 
                            src='{{ $page.RelPermalink }}{{ index . "content" }}{{ . }}'
                            alt='{{ index . "alt_text" }}'
                        >
                    {{ end }}
                </div>
                <div class="text">
                    <h3>{{ .Title }}</h3>

                    <p> 
                        {{ $authors_maybelink := slice }}
                        {{ range .Params.authors }}
                            {{ if .url }}
                                {{ $authors_maybelink = $authors_maybelink | append (printf "<a href=\"%s\">%s</a>" .url .name) }}
                            {{ else }}
                                {{ $authors_maybelink = $authors_maybelink | append .name }}
                            {{ end }}
                        {{ end }}
                        {{ delimit $authors_maybelink ", " | safeHTML }}
                    </p>
                    
                    <p>{{ .Params.description }}</p>
                    {{ range .Params.links }}
                        <a href="{{ .url }}">{{ .text }}</a>
                    {{ end }}
                </div>
            </div>
        {{ end }}
    </div>
{{ end }}